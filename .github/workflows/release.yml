name: Publish
on:
    workflow_dispatch:
    release:
        types: [ created ]
jobs:
    publish:
        runs-on: ubuntu-latest
        steps:
            -   name: Checkout
                uses: actions/checkout@v3

            -   name: Setup Java
                uses: actions/setup-java@v3
                with:
                    distribution: zulu
                    java-version: 8
                    architecture: x64
                    cache: maven
                    server-id: ossrh
                    server-username: OSSRH_MAVEN_USERNAME
                    server-password: OSSRH_MAVEN_PASSWORD
                    gpg-private-key: ${{ secrets.GPG_PRIVATE_KEY }}
                    gpg-passphrase: GPG_PASSPHRASE

            -   name: Maven Deploy
                run: |
                    mvn --batch-mode \
                        --errors \
                        --debug \
                        --activate-profiles release \
                        deploy
                env:
                    OSSRH_MAVEN_USERNAME: ${{ secrets.OSSRH_MAVEN_USERNAME }}
                    OSSRH_MAVEN_PASSWORD: ${{ secrets.OSSRH_MAVEN_PASSWORD }}
                    GPG_PASSPHRASE: ${{ secrets.GPG_PASSPHRASE }}
