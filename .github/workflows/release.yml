name: Publish to Maven Central via OSSHR
on:
    workflow_dispatch:
    release:
        types: [ created ]
jobs:
    publish:
        runs-on: ubuntu-latest
        steps:
            -   name: Checkout
                uses: actions/checkout@v3

            -   name: Setup Java for OSSHR
                uses: actions/setup-java@v3
                with:
                    distribution: zulu
                    java-version: 8
                    architecture: x64
                    cache: maven
                    server-id: osshr
                    server-username: OSSRH_MAVEN_PASSWORD
                    server-password: OSSRH_MAVEN_USERNAME
                    gpg-private-key: ${{ secrets.GPG_PRIVATE_KEY }}
                    gpg-passphrase: GPG_PASSPHRASE

            -   name: Maven Deploy to OSSHR
                run: mvn --batch-mode --activate-profiles release deploy
                env:
                    OSSRH_MAVEN_PASSWORD: ${{ secrets.OSSRH_MAVEN_PASSWORD }}
                    OSSRH_MAVEN_USERNAME: ${{ secrets.OSSRH_MAVEN_USERNAME }}
                    GPG_PASSPHRASE: ${{ secrets.GPG_PASSPHRASE }}
